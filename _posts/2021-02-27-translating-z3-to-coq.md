---
date: 2021-02-27 09:35:44+00:00
layout: post
title: Translating My Z3 Tutorial to Coq
categories:
- Formal Methods
tags:
- python
- z3
- coq

---



<link rel="stylesheet" href="/assets/alectryon/alectryon.css" type="text/css" />
<link rel="stylesheet" href="/assets/alectryon/tango_subtle.css" type="text/css" />
<link rel="stylesheet" href="/assets/alectryon/tango_subtle.min.css" type="text/css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />



<p>I had a fun time giving a Z3 tutorial at Formal Methods for the Informal Engineer (FMIE) <a class="reference external" href="https://fmie2021.github.io/">https://fmie2021.github.io/</a> (videos coming soon hopefully!). I got to be kind of the &quot;fun dad&quot; with the Z3 tutorial <a class="reference external" href="https://github.com/philzook58/z3_tutorial">https://github.com/philzook58/z3_tutorial</a> , while at times it felt a bit like Cody's Coq tutorial <a class="reference external" href="https://github.com/codyroux/broad-coq-tutorial">https://github.com/codyroux/broad-coq-tutorial</a> was trying to feed the kids their vegetables. He knew it was going to be like this from the outset and had a fun little analogy of me downhill skiing while he was about to go on a cross country slog.</p>
There are a number of factors to lead to this: 
- I could use Z3's python bindings giving an air of familiarity, whereas everything was incredibly foreign in Coq.
- Z3 can actually be used to declaratively state problems and pushbutton calculate solutions to them with very little user help, which gives it a lot more &quot;Wow&quot; factor.
- Coq is a tool that requires significantly more background to even comprehend what the hell it is. I still think many aspects of it are totally bizarre. But Coq users, this is just the water they swim in. For example, defining an inductive predicate as a datatype is still a bizarre notion to me, but it is Coq 101. I say this to Coq users and they look at me like I'm nuts. "What could even be the problem?"
<p>Anyway, a fun exercise for me was to take the examples from my tutorial and try to translate them into Coq. For the most part I think it isn't that hard and rather educational.</p>
<p>It's interesting the things that show up. Because the Z3 tutorial was designed for automation, the more automated tactics in MicroOmega and Ring are super useful. 
The thing is that the sort of proofs that show up here are fine and all, but they aren't going to teach you to fish for yourself. When you step out of this super automatable fragment you're sunk if you don't know other techniques, like the ones Cody was teaching. There may be a better balance of fun and education to be found.</p>
<p>I think there is a hole in the educational content out there on Coq. Software Foundations focuses on the rudiments, CPDT and FRAP kind of takes it a little hardcore, and the Mathematical Componenets stuff makes you buy in on ssreflect style and some hardcore math topics, both of which are nuts I have not cracked. Also, all of them are really long and initimidating. Seems like there should be something a little more breezy, a little more automatic. It is demoralizing as a beginner to either not know how to prove obvious trivial facts, or even to struggle to do so at great length.</p>
<p>This was also a nice opportunity to take Alectryon out for a spin <a class="reference external" href="https://github.com/cpitclaudel/alectryon">https://github.com/cpitclaudel/alectryon</a> Alectryon allows you to see the proof state on hover over in your browser. It's a super important part of the Coq. It was pretty easy to put in my blog. Just copy and paste the gnarly html output into a Jekyll post and make sure to link in the CSS files in an assets folder, because they are where the magic happens.</p>
The gist for this post is here <https://gist.github.com/philzook58/acd204b4895c41f9e85618f0f6b30a58>
<div class="section" id="intro-stuff">
<h1>Intro Stuff</h1>
<p>The very first problem in the tutorial was</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight"><span class="sd">(** python</span>
<span class="sd">x = Int(&#39;x&#39;)</span>
<span class="sd">y = Int(&#39;y&#39;)</span>
<span class="sd">solve(x &gt; 2, y &lt; 10, x + 2*y == 7)</span>
<span class="sd">*)</span></span></span></pre><p>which Z3 returns the solution [y = 0, x = 7].</p>
<p>However, it is easy to get Coq to confirm the validity of this solution given that you know about the [lia] tactic. Otherwise it may be kind of annoying. In general, this may be a valid approach, use external tools to produce solutions and just manually place them into Coq.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> Lia.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk0"><span class="highlight"><span class="kn">Goal</span> <span class="kr">exists</span> <span class="nv">x</span> <span class="nv">y</span>, x &gt; <span class="mi">2</span> /\ y &lt; <span class="mi">10</span> /\ x + <span class="mi">2</span> * y = <span class="mi">7</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">x</span> <span class="nv">y</span> : nat, x &gt; <span class="mi">2</span> /\ y &lt; <span class="mi">10</span> /\ x + <span class="mi">2</span> * y = <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">     </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk1"><span class="highlight"><span class="kr">exists</span> <span class="mi">7</span>, <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">7</span> &gt; <span class="mi">2</span> /\ <span class="mi">0</span> &lt; <span class="mi">10</span> /\ <span class="mi">7</span> + <span class="mi">2</span> * <span class="mi">0</span> = <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><p>A different automated version. Giving the appropriate hint database can matter a lot.
<a class="reference external" href="https://coq.inria.fr/refman/proofs/automatic-tactics/auto.html#hint-databases-defined-in-the-coq-standard-library">https://coq.inria.fr/refman/proofs/automatic-tactics/auto.html#hint-databases-defined-in-the-coq-standard-library</a></p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk2"><span class="highlight"><span class="kn">Goal</span> <span class="kr">exists</span> <span class="nv">x</span> <span class="nv">y</span>, x &gt; <span class="mi">2</span> /\ y &lt; <span class="mi">10</span> /\ x + <span class="mi">2</span> * y = <span class="mi">7</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">x</span> <span class="nv">y</span> : nat, x &gt; <span class="mi">2</span> /\ y &lt; <span class="mi">10</span> /\ x + <span class="mi">2</span> * y = <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">     </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk3"><span class="highlight"><span class="kr">exists</span> <span class="mi">7</span>, <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">7</span> &gt; <span class="mi">2</span> /\ <span class="mi">0</span> &lt; <span class="mi">10</span> /\ <span class="mi">7</span> + <span class="mi">2</span> * <span class="mi">0</span> = <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">eauto with</span> arith.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><p>It turns out, surprisingly to me, that stock eauto is sufficient to actually solve the problem without supplying the solutions. They are discovered via unification and a prolog like search. This found the different solution x = 3, y = 2</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk4"><span class="highlight"><span class="kn">Definition</span> <span class="nf">solution</span> : <span class="kr">exists</span> <span class="nv">x</span> <span class="nv">y</span>, x &gt; <span class="mi">2</span> /\ y &lt; <span class="mi">10</span> /\ x + <span class="mi">2</span> * y = <span class="mi">7</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">x</span> <span class="nv">y</span> : nat, x &gt; <span class="mi">2</span> /\ y &lt; <span class="mi">10</span> /\ x + <span class="mi">2</span> * y = <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">eexists</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">eauto with</span> arith.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk5"><span class="highlight"><span class="kn">Show Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight">(ex_intro
   (<span class="kr">fun</span> <span class="nv">x</span> : nat =&gt;
    <span class="kr">exists</span> <span class="nv">y</span> : nat, x &gt; <span class="mi">2</span> /\ y &lt; <span class="mi">10</span> /\ x + <span class="mi">2</span> * y = <span class="mi">7</span>)
   <span class="mi">3</span>
   (ex_intro
      (<span class="kr">fun</span> <span class="nv">y</span> : nat =&gt; <span class="mi">3</span> &gt; <span class="mi">2</span> /\ y &lt; <span class="mi">10</span> /\ <span class="mi">3</span> + <span class="mi">2</span> * y = <span class="mi">7</span>)
      <span class="mi">2</span>
      (conj (Gt.gt_Sn_n <span class="mi">2</span>)
         (conj
            (Lt.lt_n_S <span class="mi">1</span> <span class="mi">9</span>
               (Lt.lt_n_S <span class="mi">0</span> <span class="mi">8</span>
                  (PeanoNat.Nat.lt_0_succ <span class="mi">7</span>))) eq_refl))))</span></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

<span class="c">(* A fairly manual version for comparison. Could be even worse. *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk6"><span class="highlight"><span class="kn">Goal</span> <span class="kr">exists</span> <span class="nv">x</span> <span class="nv">y</span>, x &gt; <span class="mi">2</span> /\ y &lt; <span class="mi">10</span> /\ x + <span class="mi">2</span> * y = <span class="mi">7</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">x</span> <span class="nv">y</span> : nat, x &gt; <span class="mi">2</span> /\ y &lt; <span class="mi">10</span> /\ x + <span class="mi">2</span> * y = <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk7"><span class="highlight"><span class="kr">exists</span> <span class="mi">7</span>, <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">7</span> &gt; <span class="mi">2</span> /\ <span class="mi">0</span> &lt; <span class="mi">10</span> /\ <span class="mi">7</span> + <span class="mi">2</span> * <span class="mi">0</span> = <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk8"><span class="highlight"><span class="nb">split</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">7</span> &gt; <span class="mi">2</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z3-tut-v-chk9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; <span class="mi">10</span> /\ <span class="mi">7</span> + <span class="mi">2</span> * <span class="mi">0</span> = <span class="mi">7</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">     </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chka"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">7</span> &gt; <span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chkb"><span class="highlight"><span class="nb">unfold</span> <span class="s2">&quot;&gt;&quot;</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> &lt; <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chkc"><span class="highlight"><span class="kn">Locate</span> <span class="s2">&quot;&lt;&quot;</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span>
<span class="s2">&quot;x &lt;= y &lt; z&quot;</span> := <span class="kn">and</span> (le x y) (lt y z) : nat_scope
(default interpretation)
<span class="s2">&quot;x &lt; y &lt;= z&quot;</span> := <span class="kn">and</span> (lt x y) (le y z) : nat_scope
(default interpretation)
<span class="s2">&quot;x &lt; y &lt; z&quot;</span> := <span class="kn">and</span> (lt x y) (lt y z) : nat_scope
(default interpretation)
<span class="s2">&quot;x &lt; y&quot;</span> := lt x y : nat_scope (default interpretation)</span></blockquote></div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> &lt; <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chkd"><span class="highlight"><span class="nb">unfold</span> <span class="s2">&quot;&lt;&quot;</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">3</span> &lt;= <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chke"><span class="highlight"><span class="kn">Print</span> le.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Inductive</span> <span class="nf">le</span> (<span class="nv">n</span> : nat) : nat -&gt; <span class="kt">Prop</span> :=
    le_n : n &lt;= n
  | le_S : <span class="kr">forall</span> <span class="nv">m</span> : nat, n &lt;= m -&gt; n &lt;= S m

<span class="kn">Arguments</span> le (_ _)%nat_scope
<span class="kn">Arguments</span> le_n _%nat_scope
<span class="kn">Arguments</span> le_S (_ _)%nat_scope</span></blockquote></div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">3</span> &lt;= <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chkf"><span class="highlight"><span class="kp">do</span> <span class="mi">4</span> <span class="nb">apply</span> 
              le_S.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">3</span> &lt;= <span class="mi">3</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> le_n.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">     </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk10"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; <span class="mi">10</span> /\ <span class="mi">7</span> + <span class="mi">2</span> * <span class="mi">0</span> = <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk11"><span class="highlight"><span class="nb">split</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; <span class="mi">10</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z3-tut-v-chk12" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">7</span> + <span class="mi">2</span> * <span class="mi">0</span> = <span class="mi">7</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk13"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; <span class="mi">10</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk14"><span class="highlight"><span class="kp">do</span> <span class="mi">9</span> <span class="nb">apply</span> le_S.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> &lt;= <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> le_n.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk15"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">7</span> + <span class="mi">2</span> * <span class="mi">0</span> = <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk16"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">7</span> = <span class="mi">7</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp"> </span></span></pre><p>The next thing is the simplest possible tautology</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight"><span class="sd">(**python</span>
<span class="sd">p = Bool(&quot;p&quot;)</span>
<span class="sd">my_true_thm = Implies(p, p)</span>
<span class="sd">prove(my_true_thm)</span>
<span class="sd">*)</span></span></span></pre><p>This is not a challenge in Coq.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk17"><span class="highlight"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">P</span>, P -&gt; P.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : <span class="kt">Type</span>, P -&gt; P</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk18"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* Even shorter proof *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk19"><span class="highlight"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">P</span>, P -&gt; P.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : <span class="kt">Type</span>, P -&gt; P</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">auto</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><p>A valid counterexample found by Z3. Here we prove the counterexample.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight"><span class="sd">(**python</span>
<span class="sd">q = Bool(&quot;q&quot;)</span>
<span class="sd">my_false_thm = Implies(q, p)</span>
<span class="sd">prove(my_false_thm)</span>

<span class="sd"># counterexample</span>
<span class="sd"># [p = False, q = True]</span>

<span class="sd">*)</span>

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk1a"><span class="highlight"><span class="kn">Goal</span> not (<span class="kt">True</span> -&gt; <span class="kt">False</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ (<span class="kt">True</span> -&gt; <span class="kt">False</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk1b"><span class="highlight"><span class="nb">unfold</span> not.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kt">True</span> -&gt; <span class="kt">False</span>) -&gt; <span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk1c"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">True</span> -&gt; <span class="kt">False</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk1d"><span class="highlight"><span class="nb">apply</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">True</span> -&gt; <span class="kt">False</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">True</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> I.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><p>The first exercise: 
Get a root of the polynomial x**3 + 3*x**2 + 4*x + 2 == 0 using z3. Can you use z3 to show this is the only solution?</p>
<p>Here we open up the reals.
It is easy enough to confirm that the solution of x=-1 is a zero using the [ring] tactic.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> Reals.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Open Scope</span> R_scope.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk1e"><span class="highlight"><span class="kn">Print Scope</span> R_scope.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight">Scope R_scope
Delimiting key <span class="kr">is</span> R
Bound to class R
<span class="s2">&quot;r ²&quot;</span> := Rsqr r
<span class="s2">&quot;x ^ y&quot;</span> := pow x y
<span class="s2">&quot;x &gt;= y&quot;</span> := Rge x y
<span class="s2">&quot;x &gt; y&quot;</span> := Rgt x y
<span class="s2">&quot;x &lt;= y &lt;= z&quot;</span> := <span class="kn">and</span> (Rle x y) (Rle y z)
<span class="s2">&quot;x &lt;= y &lt; z&quot;</span> := <span class="kn">and</span> (Rle x y) (Rlt y z)
<span class="s2">&quot;x &lt;= y&quot;</span> := Rle x y
<span class="s2">&quot;x &lt; y &lt;= z&quot;</span> := <span class="kn">and</span> (Rlt x y) (Rle y z)
<span class="s2">&quot;x &lt; y &lt; z&quot;</span> := <span class="kn">and</span> (Rlt x y) (Rlt y z)
<span class="s2">&quot;x &lt; y&quot;</span> := Rlt x y
<span class="s2">&quot;x / y&quot;</span> := Rdiv x y
<span class="s2">&quot;x - y&quot;</span> := Rminus x y
<span class="s2">&quot;x + y&quot;</span> := Rplus x y
<span class="s2">&quot;x * y&quot;</span> := Rmult x y
<span class="s2">&quot;/ x&quot;</span> := RinvImpl.Rinv x
<span class="s2">&quot;- x&quot;</span> := Ropp x
</span></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk1f"><span class="highlight"><span class="kn">Goal</span> <span class="kr">exists</span> <span class="nv">x</span> : R, x^<span class="mi">3</span> + <span class="mi">3</span> * x^<span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> = <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">x</span> : R, x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk20"><span class="highlight"><span class="kr">exists</span> (- <span class="mi">1</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(-<span class="mi">1</span>) ^ <span class="mi">3</span> + <span class="mi">3</span> * (-<span class="mi">1</span>) ^ <span class="mi">2</span> + <span class="mi">4</span> * -<span class="mi">1</span> + <span class="mi">2</span> = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">ring</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><p>Proving there is no other solution is a bit trickier. A important lemma about a polynomial factor of x^3 + 3 * x^2 + 4 * x + 2</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> Lra.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk21"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_poly</span> : <span class="kr">forall</span> <span class="nv">x</span>, x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &gt; <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : R, x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk22"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">nra</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* A slightly more manual proof involving completing the square.*)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk23"><span class="highlight"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">x</span>, x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &gt; <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : R, x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk24"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk25"><span class="highlight"><span class="nb">assert</span> (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> = (x + <span class="mi">1</span>) ^ <span class="mi">2</span> + <span class="mi">1</span>) <span class="kr">as</span> H <span class="bp">by</span> <span class="bp">ring</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> = (x + <span class="mi">1</span>) ^ <span class="mi">2</span> + <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk26"><span class="highlight"><span class="nb">rewrite</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> = (x + <span class="mi">1</span>) ^ <span class="mi">2</span> + <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x + <span class="mi">1</span>) ^ <span class="mi">2</span> + <span class="mi">1</span> &gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk27"><span class="highlight"><span class="kn">Search</span> (<span class="mi">0</span> &lt;= _ ^ <span class="mi">2</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight">pow2_ge_0: <span class="kr">forall</span> <span class="nv">x</span> : R, <span class="mi">0</span> &lt;= x ^ <span class="mi">2</span></span></blockquote></div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> = (x + <span class="mi">1</span>) ^ <span class="mi">2</span> + <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x + <span class="mi">1</span>) ^ <span class="mi">2</span> + <span class="mi">1</span> &gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk28"><span class="highlight"><span class="nb">pose</span> (pow2_ge_0 (x + <span class="mi">1</span>)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> = (x + <span class="mi">1</span>) ^ <span class="mi">2</span> + <span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">pow2_ge_0 (x + <span class="mi">1</span>)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt;= (x + <span class="mi">1</span>) ^ <span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x + <span class="mi">1</span>) ^ <span class="mi">2</span> + <span class="mi">1</span> &gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lra</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">


<span class="c">(* I&#39;m actually a little suprised [nra] sufficed here and not psatz. *)</span>

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk29"><span class="highlight"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">x</span>, x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span> -&gt; (x^<span class="mi">3</span> + <span class="mi">3</span> * x^<span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span>) &lt;&gt; <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : R,
x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span> -&gt; x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> &lt;&gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk2a"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> &lt;&gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk2b"><span class="highlight"><span class="nb">assert</span> ((x^<span class="mi">3</span> + <span class="mi">3</span> * x^<span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span>) = 
         ((x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> ))) <span class="kr">as</span> H0 <span class="bp">by</span> <span class="bp">ring</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> =
(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> &lt;&gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk2c"><span class="highlight"><span class="nb">rewrite</span> H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> =
(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>) &lt;&gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk2d"><span class="highlight"><span class="nb">pose</span> (pos_poly x).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> =
(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">pos_poly x</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &gt; <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>) &lt;&gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">nra</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* A slightly more manual proof *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk2e"><span class="highlight"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">x</span>, x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span> -&gt; (x^<span class="mi">3</span> + <span class="mi">3</span> * x^<span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span>) &lt;&gt; <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : R,
x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span> -&gt; x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> &lt;&gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk2f"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> &lt;&gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk30"><span class="highlight"><span class="nb">assert</span> ((x^<span class="mi">3</span> + <span class="mi">3</span> * x^<span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span>) = 
         ((x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> ))) <span class="bp">by</span> <span class="bp">ring</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> =
(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> &lt;&gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk31"><span class="highlight"><span class="nb">rewrite</span> H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> =
(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>) &lt;&gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk32"><span class="highlight"><span class="nb">pose</span> (pos_poly x).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> =
(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">pos_poly x</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &gt; <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>) &lt;&gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk33"><span class="highlight"><span class="kn">Search</span> (_ * _ = <span class="mi">0</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight">Rmult_0_l: <span class="kr">forall</span> <span class="nv">r</span> : R, <span class="mi">0</span> * r = <span class="mi">0</span></span></blockquote><blockquote class="alectryon-message"><span class="highlight">Rmult_0_r: <span class="kr">forall</span> <span class="nv">r</span> : R, r * <span class="mi">0</span> = <span class="mi">0</span></span></blockquote><blockquote class="alectryon-message"><span class="highlight">Rmult_eq_0_compat_l:
  <span class="kr">forall</span> <span class="nv">r1</span> <span class="nv">r2</span> : R, r2 = <span class="mi">0</span> -&gt; r1 * r2 = <span class="mi">0</span></span></blockquote><blockquote class="alectryon-message"><span class="highlight">Rmult_eq_0_compat_r:
  <span class="kr">forall</span> <span class="nv">r1</span> <span class="nv">r2</span> : R, r1 = <span class="mi">0</span> -&gt; r1 * r2 = <span class="mi">0</span></span></blockquote><blockquote class="alectryon-message"><span class="highlight">Rmult_eq_0_compat:
  <span class="kr">forall</span> <span class="nv">r1</span> <span class="nv">r2</span> : R, r1 = <span class="mi">0</span> \/ r2 = <span class="mi">0</span> -&gt; r1 * r2 = <span class="mi">0</span></span></blockquote><blockquote class="alectryon-message"><span class="highlight">Rmult_integral:
  <span class="kr">forall</span> <span class="nv">r1</span> <span class="nv">r2</span> : R, r1 * r2 = <span class="mi">0</span> -&gt; r1 = <span class="mi">0</span> \/ r2 = <span class="mi">0</span></span></blockquote><blockquote class="alectryon-message"><span class="highlight">Rmult_integral_contrapositive_currified:
  <span class="kr">forall</span> <span class="nv">r1</span> <span class="nv">r2</span> : R, r1 &lt;&gt; <span class="mi">0</span> -&gt; r2 &lt;&gt; <span class="mi">0</span> -&gt; r1 * r2 &lt;&gt; <span class="mi">0</span></span></blockquote><blockquote class="alectryon-message"><span class="highlight">Rmult_neq_0_reg:
  <span class="kr">forall</span> <span class="nv">r1</span> <span class="nv">r2</span> : R, r1 * r2 &lt;&gt; <span class="mi">0</span> -&gt; r1 &lt;&gt; <span class="mi">0</span> /\ r2 &lt;&gt; <span class="mi">0</span></span></blockquote><blockquote class="alectryon-message"><span class="highlight">Rmult_integral_contrapositive:
  <span class="kr">forall</span> <span class="nv">r1</span> <span class="nv">r2</span> : R, r1 &lt;&gt; <span class="mi">0</span> /\ r2 &lt;&gt; <span class="mi">0</span> -&gt; r1 * r2 &lt;&gt; <span class="mi">0</span></span></blockquote><blockquote class="alectryon-message"><span class="highlight">sqrt3_2_neq_0: <span class="mi">2</span> * sqrt <span class="mi">3</span> &lt;&gt; <span class="mi">0</span></span></blockquote><blockquote class="alectryon-message"><span class="highlight">powerRZ_mult_distr:
  <span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">x</span> <span class="nv">y</span> : R),
  (<span class="mi">0</span> &lt;= m)%Z \/ x * y &lt;&gt; <span class="mi">0</span> -&gt;
  powerRZ (x * y) m = powerRZ x m * powerRZ y m</span></blockquote></div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> =
(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">pos_poly x</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &gt; <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>) &lt;&gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk34"><span class="highlight"><span class="nb">apply</span> Rmult_integral_contrapositive_currified.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> =
(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">pos_poly x</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &gt; <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z3-tut-v-chk35" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> =
(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">pos_poly x</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &gt; <span class="mi">0</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z3-tut-v-chk35"><hr></label><div class="goal-conclusion"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &lt;&gt; <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk36"><span class="highlight"><span class="bp">assumption</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x + <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">3</span> + <span class="mi">3</span> * x ^ <span class="mi">2</span> + <span class="mi">4</span> * x + <span class="mi">2</span> =
(x + <span class="mi">1</span>) * (x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">pos_poly x</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &gt; <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x ^ <span class="mi">2</span> + <span class="mi">2</span> * x + <span class="mi">2</span> &lt;&gt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lra</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Close Scope</span> R_scope.</span></span></span></pre></div>
<div class="section" id="the-send-more-money-puzzle">
<h1>The send + more = money Puzzle</h1>
<p>There is an assignment of unique digits to letters such that the equation send + more = money holds. Find an assignment of the digits to make this true.</p>
<p>Here is a Z3 version:</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight"><span class="sd">(**python</span>
<span class="sd">digits = Ints(&#39;s e n d m o r y&#39;)</span>
<span class="sd">s,e,n,d,m,o,r,y = digits</span>

<span class="sd">send = Sum([10**(3-i) * d for i,d in enumerate([s,e,n,d])]) # convert digits of number to number</span>
<span class="sd">more = Sum([10**(3-i) * d for i,d in enumerate([m,o,r,e])])</span>
<span class="sd">money = Sum([10**(4-i) * d for i,d in enumerate([m,o,n,e,y])])</span>
<span class="sd">solver = Solver()</span>
<span class="sd">solver.add([s &gt; 0, m &gt; 0]) # first digits are nonzero</span>

<span class="sd"># Constrain all digits constrained to be 0 through 9</span>
<span class="sd">solver.add([  And( 0 &lt;= d, d &lt;= 9 )   for d in digits])</span>

<span class="sd"># Constrain all digits to be unique (Hint: Look at the 8-Queens constraints. Anything useful?)</span>
<span class="sd">solver.add(Distinct(digits))</span>

<span class="sd"># Constrain send + more == money</span>
<span class="sd">solver.add(send + more == money)</span>

<span class="sd">solver.check()</span>
<span class="sd">solver.model()</span>
<span class="sd">*)</span></span></span></pre><p>Again we can compute in Z3 and just verify in Coq.</p>
<p>I basically always want lists and list notation and can never remember where to find them. I think they should be on by default.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">From</span> Coq <span class="kn">Require Import</span> List.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Import</span> ListNotations.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* Convert list of digits to number *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">decimal_list</span> <span class="nv">l</span> :=
   <span class="kr">let fix</span> <span class="nv">decimal_list_aux</span> <span class="nv">acc</span> <span class="nv">l</span> := <span class="kr">match</span> l <span class="kr">with</span>
         | h :: t =&gt; acc * h + decimal_list_aux (<span class="mi">10</span> * acc) t
         | [] =&gt; <span class="mi">0</span>
         <span class="kr">end</span> 
   <span class="kr">in</span> 
   decimal_list_aux <span class="mi">1</span> (List.rev l).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk37"><span class="highlight"><span class="kn">Compute</span> decimal_list [<span class="mi">1</span>;<span class="mi">2</span>;<span class="mi">3</span>].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight">= <span class="mi">123</span>
: nat</span></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">all_different</span> (<span class="nv">l</span> : list nat) : <span class="kt">Prop</span> := <span class="kr">match</span> l <span class="kr">with</span>
   | h :: t =&gt; List.fold_left (<span class="kr">fun</span> <span class="nv">acc</span> <span class="nv">x</span> =&gt; (h &lt;&gt; x)  /\ acc ) t   (all_different t)
   | [] =&gt; <span class="kt">True</span>
   <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk38"><span class="highlight"><span class="kn">Eval</span> <span class="nb">simpl</span> <span class="kr">in</span> all_different [<span class="mi">1</span> ; <span class="mi">2</span> ; <span class="mi">3</span>].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight">= <span class="mi">1</span> &lt;&gt; <span class="mi">3</span> /\ <span class="mi">1</span> &lt;&gt; <span class="mi">2</span> /\ <span class="mi">2</span> &lt;&gt; <span class="mi">3</span> /\ <span class="kt">True</span>
: <span class="kt">Prop</span></span></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk39"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">send_more_money</span> : <span class="kr">exists</span> <span class="nv">s</span> <span class="nv">e</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">m</span> <span class="nv">o</span> <span class="nv">r</span> <span class="nv">y</span>,
   <span class="kr">let</span> <span class="nv">digits</span> := [s ;e ;n ;d; m; o; r; y] <span class="kr">in</span>
   <span class="kr">let</span> <span class="nv">send</span> := decimal_list [s ;e; n; d] <span class="kr">in</span>
   <span class="kr">let</span> <span class="nv">more</span> := decimal_list [m ;o; r; e] <span class="kr">in</span>
   <span class="kr">let</span> <span class="nv">money</span> := decimal_list [m ; o ; n ; e; y] <span class="kr">in</span>
   s &gt; <span class="mi">0</span> /\ m &gt; <span class="mi">0</span> /\ Refl.make_conj (<span class="kr">fun</span> <span class="nv">x</span> =&gt; x &lt;= <span class="mi">9</span>) digits /\
   all_different digits
   /\ send + more = money.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">s</span> <span class="nv">e</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">m</span> <span class="nv">o</span> <span class="nv">r</span> <span class="nv">y</span> : nat,
  <span class="kr">let</span> <span class="nv">digits</span> := [s; e; n; d; m; o; r; y] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">send</span> := decimal_list [s; e; n; d] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">more</span> := decimal_list [m; o; r; e] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">money</span> := decimal_list [m; o; n; e; y] <span class="kr">in</span>
  s &gt; <span class="mi">0</span> /\
  m &gt; <span class="mi">0</span> /\
  Refl.make_conj (<span class="kr">fun</span> <span class="nv">x</span> : nat =&gt; x &lt;= <span class="mi">9</span>) digits /\
  all_different digits /\ send + more = money</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk3a"><span class="highlight"><span class="kr">exists</span> <span class="mi">9</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">e</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">m</span> <span class="nv">o</span> <span class="nv">r</span> <span class="nv">y</span> : nat,
  <span class="kr">let</span> <span class="nv">digits</span> := [<span class="mi">9</span>; e; n; d; m; o; r; y] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">send</span> := decimal_list [<span class="mi">9</span>; e; n; d] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">more</span> := decimal_list [m; o; r; e] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">money</span> := decimal_list [m; o; n; e; y] <span class="kr">in</span>
  <span class="mi">9</span> &gt; <span class="mi">0</span> /\
  m &gt; <span class="mi">0</span> /\
  Refl.make_conj (<span class="kr">fun</span> <span class="nv">x</span> : nat =&gt; x &lt;= <span class="mi">9</span>) digits /\
  all_different digits /\ send + more = money</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk3b"><span class="highlight"><span class="kr">exists</span> <span class="mi">5</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">m</span> <span class="nv">o</span> <span class="nv">r</span> <span class="nv">y</span> : nat,
  <span class="kr">let</span> <span class="nv">digits</span> := [<span class="mi">9</span>; <span class="mi">5</span>; n; d; m; o; r; y] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">send</span> := decimal_list [<span class="mi">9</span>; <span class="mi">5</span>; n; d] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">more</span> := decimal_list [m; o; r; <span class="mi">5</span>] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">money</span> := decimal_list [m; o; n; <span class="mi">5</span>; y] <span class="kr">in</span>
  <span class="mi">9</span> &gt; <span class="mi">0</span> /\
  m &gt; <span class="mi">0</span> /\
  Refl.make_conj (<span class="kr">fun</span> <span class="nv">x</span> : nat =&gt; x &lt;= <span class="mi">9</span>) digits /\
  all_different digits /\ send + more = money</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk3c"><span class="highlight"><span class="kr">exists</span> <span class="mi">6</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d</span> <span class="nv">m</span> <span class="nv">o</span> <span class="nv">r</span> <span class="nv">y</span> : nat,
  <span class="kr">let</span> <span class="nv">digits</span> := [<span class="mi">9</span>; <span class="mi">5</span>; <span class="mi">6</span>; d; m; o; r; y] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">send</span> := decimal_list [<span class="mi">9</span>; <span class="mi">5</span>; <span class="mi">6</span>; d] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">more</span> := decimal_list [m; o; r; <span class="mi">5</span>] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">money</span> := decimal_list [m; o; <span class="mi">6</span>; <span class="mi">5</span>; y] <span class="kr">in</span>
  <span class="mi">9</span> &gt; <span class="mi">0</span> /\
  m &gt; <span class="mi">0</span> /\
  Refl.make_conj (<span class="kr">fun</span> <span class="nv">x</span> : nat =&gt; x &lt;= <span class="mi">9</span>) digits /\
  all_different digits /\ send + more = money</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk3d"><span class="highlight"><span class="kr">exists</span> <span class="mi">7</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">m</span> <span class="nv">o</span> <span class="nv">r</span> <span class="nv">y</span> : nat,
  <span class="kr">let</span> <span class="nv">digits</span> := [<span class="mi">9</span>; <span class="mi">5</span>; <span class="mi">6</span>; <span class="mi">7</span>; m; o; r; y] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">send</span> := decimal_list [<span class="mi">9</span>; <span class="mi">5</span>; <span class="mi">6</span>; <span class="mi">7</span>] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">more</span> := decimal_list [m; o; r; <span class="mi">5</span>] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">money</span> := decimal_list [m; o; <span class="mi">6</span>; <span class="mi">5</span>; y] <span class="kr">in</span>
  <span class="mi">9</span> &gt; <span class="mi">0</span> /\
  m &gt; <span class="mi">0</span> /\
  Refl.make_conj (<span class="kr">fun</span> <span class="nv">x</span> : nat =&gt; x &lt;= <span class="mi">9</span>) digits /\
  all_different digits /\ send + more = money</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk3e"><span class="highlight"><span class="kr">exists</span> <span class="mi">1</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">o</span> <span class="nv">r</span> <span class="nv">y</span> : nat,
  <span class="kr">let</span> <span class="nv">digits</span> := [<span class="mi">9</span>; <span class="mi">5</span>; <span class="mi">6</span>; <span class="mi">7</span>; <span class="mi">1</span>; o; r; y] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">send</span> := decimal_list [<span class="mi">9</span>; <span class="mi">5</span>; <span class="mi">6</span>; <span class="mi">7</span>] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">more</span> := decimal_list [<span class="mi">1</span>; o; r; <span class="mi">5</span>] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">money</span> := decimal_list [<span class="mi">1</span>; o; <span class="mi">6</span>; <span class="mi">5</span>; y] <span class="kr">in</span>
  <span class="mi">9</span> &gt; <span class="mi">0</span> /\
  <span class="mi">1</span> &gt; <span class="mi">0</span> /\
  Refl.make_conj (<span class="kr">fun</span> <span class="nv">x</span> : nat =&gt; x &lt;= <span class="mi">9</span>) digits /\
  all_different digits /\ send + more = money</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk3f"><span class="highlight"><span class="kr">exists</span> <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">r</span> <span class="nv">y</span> : nat,
  <span class="kr">let</span> <span class="nv">digits</span> := [<span class="mi">9</span>; <span class="mi">5</span>; <span class="mi">6</span>; <span class="mi">7</span>; <span class="mi">1</span>; <span class="mi">0</span>; r; y] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">send</span> := decimal_list [<span class="mi">9</span>; <span class="mi">5</span>; <span class="mi">6</span>; <span class="mi">7</span>] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">more</span> := decimal_list [<span class="mi">1</span>; <span class="mi">0</span>; r; <span class="mi">5</span>] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">money</span> := decimal_list [<span class="mi">1</span>; <span class="mi">0</span>; <span class="mi">6</span>; <span class="mi">5</span>; y] <span class="kr">in</span>
  <span class="mi">9</span> &gt; <span class="mi">0</span> /\
  <span class="mi">1</span> &gt; <span class="mi">0</span> /\
  Refl.make_conj (<span class="kr">fun</span> <span class="nv">x</span> : nat =&gt; x &lt;= <span class="mi">9</span>) digits /\
  all_different digits /\ send + more = money</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk40"><span class="highlight"><span class="kr">exists</span> <span class="mi">8</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">y</span> : nat,
  <span class="kr">let</span> <span class="nv">digits</span> := [<span class="mi">9</span>; <span class="mi">5</span>; <span class="mi">6</span>; <span class="mi">7</span>; <span class="mi">1</span>; <span class="mi">0</span>; <span class="mi">8</span>; y] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">send</span> := decimal_list [<span class="mi">9</span>; <span class="mi">5</span>; <span class="mi">6</span>; <span class="mi">7</span>] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">more</span> := decimal_list [<span class="mi">1</span>; <span class="mi">0</span>; <span class="mi">8</span>; <span class="mi">5</span>] <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">money</span> := decimal_list [<span class="mi">1</span>; <span class="mi">0</span>; <span class="mi">6</span>; <span class="mi">5</span>; y] <span class="kr">in</span>
  <span class="mi">9</span> &gt; <span class="mi">0</span> /\
  <span class="mi">1</span> &gt; <span class="mi">0</span> /\
  Refl.make_conj (<span class="kr">fun</span> <span class="nv">x</span> : nat =&gt; x &lt;= <span class="mi">9</span>) digits /\
  all_different digits /\ send + more = money</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk41"><span class="highlight"><span class="kr">exists</span> <span class="mi">2</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> <span class="nv">digits</span> := [<span class="mi">9</span>; <span class="mi">5</span>; <span class="mi">6</span>; <span class="mi">7</span>; <span class="mi">1</span>; <span class="mi">0</span>; <span class="mi">8</span>; <span class="mi">2</span>] <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">send</span> := decimal_list [<span class="mi">9</span>; <span class="mi">5</span>; <span class="mi">6</span>; <span class="mi">7</span>] <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">more</span> := decimal_list [<span class="mi">1</span>; <span class="mi">0</span>; <span class="mi">8</span>; <span class="mi">5</span>] <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">money</span> := decimal_list [<span class="mi">1</span>; <span class="mi">0</span>; <span class="mi">6</span>; <span class="mi">5</span>; <span class="mi">2</span>] <span class="kr">in</span>
<span class="mi">9</span> &gt; <span class="mi">0</span> /\
<span class="mi">1</span> &gt; <span class="mi">0</span> /\
Refl.make_conj (<span class="kr">fun</span> <span class="nv">x</span> : nat =&gt; x &lt;= <span class="mi">9</span>) digits /\
all_different digits /\ send + more = money</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk42"><span class="highlight"><span class="nb">cbv</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> &lt;= <span class="mi">9</span> /\
<span class="mi">1</span> &lt;= <span class="mi">1</span> /\
(<span class="mi">9</span> &lt;= <span class="mi">9</span> /\
 <span class="mi">5</span> &lt;= <span class="mi">9</span> /\
 <span class="mi">6</span> &lt;= <span class="mi">9</span> /\
 <span class="mi">7</span> &lt;= <span class="mi">9</span> /\ <span class="mi">1</span> &lt;= <span class="mi">9</span> /\ <span class="mi">0</span> &lt;= <span class="mi">9</span> /\ <span class="mi">8</span> &lt;= <span class="mi">9</span> /\ <span class="mi">2</span> &lt;= <span class="mi">9</span>) /\
((<span class="mi">9</span> = <span class="mi">2</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">9</span> = <span class="mi">8</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">9</span> = <span class="mi">0</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">9</span> = <span class="mi">1</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">9</span> = <span class="mi">7</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">9</span> = <span class="mi">6</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">9</span> = <span class="mi">5</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">5</span> = <span class="mi">2</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">5</span> = <span class="mi">8</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">5</span> = <span class="mi">0</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">5</span> = <span class="mi">1</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">5</span> = <span class="mi">7</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">5</span> = <span class="mi">6</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">6</span> = <span class="mi">2</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">6</span> = <span class="mi">8</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">6</span> = <span class="mi">0</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">6</span> = <span class="mi">1</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">6</span> = <span class="mi">7</span> -&gt; <span class="kt">False</span>) /\
 (<span class="mi">7</span> = <span class="mi">2</span> -&gt; <span class="kt">False</span>) /\
 (... -&gt; <span class="kt">False</span>) /\ (...) /\ ... /\ ...) /\
<span class="mi">10652</span> = <span class="mi">10652</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><p>But if we want to try solving the problem in coq, here is an approach.
This is a send more money solver translated fairly verbatim from Haskell. <a class="reference external" href="https://blog.plover.com/prog/haskell/monad-search.html">https://blog.plover.com/prog/haskell/monad-search.html</a>
It turned out that using Int63 was much much faster than using peano nat (0.5s vs 20mins), probably because of checking the addition send + more == money</p>
<p>This solver isn't verified, but it does give you a way of computing the puzzle without leaving coq. Interesting question: How do make a efficient toolbox of verified finite domain solvers?</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">find_money</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk43"><span class="highlight"><span class="kn">Require Import</span> Int63.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight">Use of “<span class="kn">Require</span>” <span class="kn">inside</span> a section <span class="kr">is</span> fragile. It <span class="kr">is</span>
not recommended to use this functionality <span class="kr">in</span> finished
proof scripts. [require-<span class="kr">in</span>-section,fragile]</span></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Open Scope</span> int63_scope.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  <span class="c">(* Convert list of digits to number *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">to_number</span> <span class="nv">l</span> := 
     <span class="kr">let fix</span> <span class="nv">decimal_list_aux</span> <span class="nv">acc</span> <span class="nv">l</span> := <span class="kr">match</span> l <span class="kr">with</span>
              | h :: t =&gt; acc * h + decimal_list_aux (<span class="mi">10</span> * acc) t
              | [] =&gt; <span class="mi">0</span>
              <span class="kr">end</span> 
     <span class="kr">in</span>
     decimal_list_aux <span class="mi">1</span> (List.rev l).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">remove</span> <span class="nv">d</span> <span class="nv">l</span> := filter (<span class="kr">fun</span> <span class="nv">x</span> =&gt; negb (existsb (eqb x) d)) l.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk44"><span class="highlight"><span class="kn">Compute</span> remove [<span class="mi">1</span>;<span class="mi">2</span>] [<span class="mi">1</span>;<span class="mi">2</span>;<span class="mi">3</span>;<span class="mi">4</span>;<span class="mi">5</span>].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight">= [<span class="mi">3</span>; <span class="mi">4</span>; <span class="mi">5</span>]
: list int</span></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="c">(* Some cute do noation syntax for lists *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;- c1 ;; c2&quot;</span> := (@flat_map _ _ (<span class="kr">fun</span> <span class="nv">x</span> =&gt; c2) c1)
  (<span class="kn">at level</span> <span class="mi">61</span>, c1 <span class="kn">at next level</span>, <span class="kn">right associativity</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">find_solution</span> :=
     <span class="kr">let</span> <span class="nv">digits</span> := [<span class="mi">0</span>;<span class="mi">1</span>;<span class="mi">2</span>;<span class="mi">3</span>;<span class="mi">4</span>;<span class="mi">5</span>;<span class="mi">6</span>;<span class="mi">7</span>;<span class="mi">8</span>;<span class="mi">9</span>] <span class="kr">in</span>
     s &lt;- remove [<span class="mi">0</span>] digits;;
     e &lt;- remove [s] digits;;
     n &lt;- remove [s;e] digits;;
     d &lt;- remove [s;e;n] digits;;
     <span class="kr">let</span> <span class="nv">send</span> := to_number [s;e;n;d] <span class="kr">in</span>
     m &lt;- remove [<span class="mi">0</span>;s;e;n;d] digits;;
     o &lt;- remove [s;e;n;d;m] digits;;
     r &lt;- remove [s;e;n;d;m;o] digits;;
     <span class="kr">let</span> <span class="nv">more</span> := to_number [m;o;r;e] <span class="kr">in</span>
     y &lt;- remove [s;e;n;d;m;o;r] digits;;
     <span class="kr">let</span> <span class="nv">money</span> := to_number [m;o;n;e;y] <span class="kr">in</span>
     <span class="kr">if</span> ((send + more) == money) <span class="kr">then</span> [(s,e,n,d,m,o,r,y)] <span class="kr">else</span> [].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="c">(* native_compute is the fastest evaluation method *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk45"><span class="highlight"><span class="kn">Eval</span> <span class="nb">native_compute</span> <span class="kr">in</span> find_solution.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight"><span class="nb">native_compute</span> disabled <span class="nb">at</span> configure <span class="kp">time</span>; falling
back to <span class="nb">vm_compute</span>.
[native-<span class="nb">compute</span>-disabled,native-compiler]</span></blockquote><blockquote class="alectryon-message"><span class="highlight">= [(<span class="mi">9</span>, <span class="mi">5</span>, <span class="mi">6</span>, <span class="mi">7</span>, <span class="mi">1</span>, <span class="mi">0</span>, <span class="mi">8</span>, <span class="mi">2</span>)]
: list
    (int * int * int * int * int * int * int *
     int)</span></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">find_money</span>.</span></span></span></pre></div>
<div class="section" id="simple-properties-of-the-reals">
<h1>Simple Properties of the Reals</h1>
<p>A Z3 version:</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight"><span class="sd">(**python</span>
<span class="sd">x,y,z = Reals(&quot;x y z&quot;)</span>
<span class="sd">prove( x + y == y + x)</span>
<span class="sd">prove( (x + y) + z == x + (y + z))s</span>
<span class="sd">prove( x*x &gt;= 0 )</span>
<span class="sd">*)</span>


</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Open Scope</span> R_scope.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk46"><span class="highlight"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : R, x + y = y + x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : R, x + y = y + x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">intros</span>; <span class="bp">ring</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk47"><span class="highlight"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : R, (x + y) + z = x + (y + z).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : R, x + y + z = x + (y + z)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">intros</span>; <span class="bp">ring</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk48"><span class="highlight"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">x</span> : R, x &gt; <span class="mi">0</span> \/ x = <span class="mi">0</span> \/ x &lt; <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : R, x &gt; <span class="mi">0</span> \/ x = <span class="mi">0</span> \/ x &lt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk49"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &gt; <span class="mi">0</span> \/ x = <span class="mi">0</span> \/ x &lt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lra</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk4a"><span class="highlight"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">x</span> : R, x ^ <span class="mi">2</span> &gt;= <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : R, x ^ <span class="mi">2</span> &gt;= <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk4b"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x ^ <span class="mi">2</span> &gt;= <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">nra</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre></div>
<div class="section" id="simple-properties-of-2d-vectors">
<h1>Simple Properties of 2D Vectors</h1>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Record</span> <span class="nf">V2</span> := {
   x : R;
   y : R
}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* vector addition *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">vadd</span> <span class="nv">v</span> <span class="nv">w</span> := {| 
   x := v.(x) + w.(x);
   y := v.(y) + w.(y) 
   |}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* scalar multiplication *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">smul</span> <span class="nv">s</span> <span class="nv">v</span> := {| x := s * v.(x) ;
 y := s * v.(y)   |}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* dot product *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">dot</span> <span class="nv">v</span> <span class="nv">w</span> := v.(x) * w.(x) + v.(y) * w.(y).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk4c"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">vadd_assoc</span> : <span class="kr">forall</span> <span class="nv">u</span> <span class="nv">v</span> <span class="nv">w</span>, vadd u (vadd v w) = vadd (vadd u v) w.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">u</span> <span class="nv">v</span> <span class="nv">w</span> : V2,
vadd u (vadd v w) = vadd (vadd u v) w</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk4d"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, v, w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">V2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">vadd u (vadd v w) = vadd (vadd u v) w</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk4e"><span class="highlight"><span class="nb">destruct</span> u, v, w.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x0, y0, x1, y1, x2, y2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">vadd {| x := x0; y := y0 |}
  (vadd {| x := x1; y := y1 |} {| x := x2; y := y2 |}) =
vadd
  (vadd {| x := x0; y := y0 |} {| x := x1; y := y1 |})
  {| x := x2; y := y2 |}</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk4f"><span class="highlight"><span class="nb">cbv</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x0, y0, x1, y1, x2, y2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{| x := x0 + (x1 + x2); y := y0 + (y1 + y2) |} =
{| x := x0 + x1 + x2; y := y0 + y1 + y2 |}</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">f_equal</span>; <span class="bp">ring</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk50"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">vadd_comm</span> : <span class="kr">forall</span> <span class="nv">u</span> <span class="nv">v</span>, vadd u v = vadd v u.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">u</span> <span class="nv">v</span> : V2, vadd u v = vadd v u</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk51"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">V2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">vadd u v = vadd v u</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk52"><span class="highlight"><span class="nb">destruct</span> u, v.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x0, y0, x1, y1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">vadd {| x := x0; y := y0 |} {| x := x1; y := y1 |} =
vadd {| x := x1; y := y1 |} {| x := x0; y := y0 |}</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk53"><span class="highlight"><span class="nb">cbv</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x0, y0, x1, y1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{| x := x0 + x1; y := y0 + y1 |} =
{| x := x1 + x0; y := y1 + y0 |}</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">f_equal</span>; <span class="bp">ring</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* We can notice a pattern in the proofs here that we can abstract *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">v2_tac</span> :=
   <span class="nb">intros</span>;
   <span class="kp">repeat</span> <span class="kr">match goal with</span>
   | [ u : V2 |- _ ] =&gt; <span class="nb">destruct</span> u
   <span class="kr">end</span>;
   <span class="nb">cbv</span> ; <span class="nb">f_equal</span>; <span class="bp">ring</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk54"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">v2_distrib</span> : <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">u</span> <span class="nv">v</span>, smul s (vadd u v) = vadd (smul s u) (smul s v).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : R) (<span class="nv">u</span> <span class="nv">v</span> : V2),
smul s (vadd u v) = vadd (smul s u) (smul s v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight">v2_tac.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> Psatz.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk55"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">cauchy_schwartz_v2</span> : <span class="kr">forall</span> <span class="nv">u</span> <span class="nv">v</span>, (dot u v) ^ <span class="mi">2</span> &lt;= (dot v v) * (dot u u).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">u</span> <span class="nv">v</span> : V2, dot u v ^ <span class="mi">2</span> &lt;= dot v v * dot u u</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk56"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">V2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">dot u v ^ <span class="mi">2</span> &lt;= dot v v * dot u u</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk57"><span class="highlight"><span class="nb">destruct</span> u, v.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x0, y0, x1, y1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">dot {| x := x0; y := y0 |} {| x := x1; y := y1 |} ^ <span class="mi">2</span> &lt;=
dot {| x := x1; y := y1 |} {| x := x1; y := y1 |} *
dot {| x := x0; y := y0 |} {| x := x0; y := y0 |}</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk58"><span class="highlight"><span class="nb">unfold</span> dot.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x0, y0, x1, y1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x {| x := x0; y := y0 |} * x {| x := x1; y := y1 |} +
 y {| x := x0; y := y0 |} * y {| x := x1; y := y1 |})
^ <span class="mi">2</span> &lt;=
(x {| x := x1; y := y1 |} * x {| x := x1; y := y1 |} +
 y {| x := x1; y := y1 |} * y {| x := x1; y := y1 |}) *
(x {| x := x0; y := y0 |} * x {| x := x0; y := y0 |} +
 y {| x := x0; y := y0 |} * y {| x := x0; y := y0 |})</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk59"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x0, y0, x1, y1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x0 * x1 + y0 * y1) * ((x0 * x1 + y0 * y1) * <span class="mi">1</span>) &lt;=
(x1 * x1 + y1 * y1) * (x0 * x0 + y0 * y0)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Abort</span>. <span class="c">(* psatz R. Qed. *)</span> <span class="c">(* Alectryon doesn&#39;t like this one for some reason, but it passes when run manually. *)</span></span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* We can define matrix multiplication *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Record</span> <span class="nf">M2</span> := {
   a : R; b : R;
   c : R; d : R
}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">mmul</span> <span class="nv">m</span> <span class="nv">v</span> :=
   {|
   x := m.(a) * v.(x) + m.(b) * v.(y);
   y := m.(c) * v.(x) + m.(d) * v.(y)  
   |}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk5a"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">mat_scalar_mul_comm</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">s</span> <span class="nv">v</span>, mmul m (smul s v) = smul s (mmul m v).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : M2) (<span class="nv">s</span> : R) (<span class="nv">v</span> : V2),
mmul m (smul s v) = smul s (mmul m v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk5b"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">M2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">V2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mmul m (smul s v) = smul s (mmul m v)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk5c"><span class="highlight"><span class="nb">destruct</span> m, v.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a0, b0, c0, d0, s, x0, y0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mmul {| a := a0; b := b0; c := c0; d := d0 |}
  (smul s {| x := x0; y := y0 |}) =
smul s
  (mmul {| a := a0; b := b0; c := c0; d := d0 |}
     {| x := x0; y := y0 |})</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk5d"><span class="highlight"><span class="nb">cbv</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a0, b0, c0, d0, s, x0, y0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{|
x := a0 * (s * x0) + b0 * (s * y0);
y := c0 * (s * x0) + d0 * (s * y0) |} =
{|
x := s * (a0 * x0 + b0 * y0);
y := s * (c0 * x0 + d0 * y0) |}</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">f_equal</span>; <span class="bp">ring</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* Update our tactic slightly to destruct the matrices also. *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">m2_tac</span> :=
   <span class="nb">intros</span>;
   <span class="kp">repeat</span> <span class="kr">match goal with</span>
   | [ u : V2 |- _ ] =&gt; <span class="nb">destruct</span> u
   | [ m : M2 |- _ ] =&gt; <span class="nb">destruct</span> m
   <span class="kr">end</span>;
   <span class="nb">cbv</span> ; <span class="nb">f_equal</span>; <span class="bp">ring</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk5e"><span class="highlight"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">u</span> <span class="nv">v</span>, mmul m (vadd u v) = vadd (mmul m u) (mmul m v).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : M2) (<span class="nv">u</span> <span class="nv">v</span> : V2),
mmul m (vadd u v) = vadd (mmul m u) (mmul m v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight">m2_tac.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Close Scope</span> R_scope.</span></span></span></pre></div>
<div class="section" id="summing-n">
<h1>Summing N</h1>
<p>Proving a closed form of the sum of 1 to n.</p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">sumn</span> <span class="nv">n</span> := <span class="kr">match</span> n <span class="kr">with</span>
 | O =&gt; O
 | S n&#39; =&gt; n + sumn n&#39;
<span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk5f"><span class="highlight"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">n</span>, <span class="mi">2</span> * sumn n = (n * (n + <span class="mi">1</span>)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, <span class="mi">2</span> * sumn n = n * (n + <span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk60"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * sumn n = n * (n + <span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">   </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk61"><span class="highlight"><span class="nb">induction</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * sumn <span class="mi">0</span> = <span class="mi">0</span> * (<span class="mi">0</span> + <span class="mi">1</span>)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z3-tut-v-chk62" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">2</span> * sumn n = n * (n + <span class="mi">1</span>)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z3-tut-v-chk62"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * sumn (S n) = S n * (S n + <span class="mi">1</span>)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk63"><span class="highlight"><span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">2</span> * sumn n = n * (n + <span class="mi">1</span>)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * sumn (S n) = S n * (S n + <span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk64"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">2</span> * sumn n = n * (n + <span class="mi">1</span>)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S (n + sumn n + S (n + sumn n + <span class="mi">0</span>)) =
S (n + <span class="mi">1</span> + n * S (n + <span class="mi">1</span>))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">ring</span> [IHn].</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre></div>
<div class="section" id="two-sort">
<h1>Two Sort</h1>
<p>I like two_sort as an example. It's a sorting function that does not require induction, so for a beginner, I feel like its a nice pedagogical thing to talk about.
You can find more complicated sorts proved in Vol 3 of Software Foundations <a class="reference external" href="https://softwarefoundations.cis.upenn.edu/vfa-current/toc.html">https://softwarefoundations.cis.upenn.edu/vfa-current/toc.html</a></p>
<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">two_sort</span> <span class="nv">x</span> <span class="nv">y</span> :=
   <span class="kr">if</span> (le_dec x y) <span class="kr">then</span> (x, y) <span class="kr">else</span> (y, x).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk65"><span class="highlight"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, <span class="kr">let</span> (<span class="nv">x&#39;</span>, y&#39;) := two_sort x y <span class="kr">in</span>
         x&#39; &lt;= y&#39; /\  
         ( (x = x&#39; /\ y = y&#39;) \/ (y = x&#39; /\ x = y&#39;) ).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : nat,
<span class="kr">let</span> (<span class="nv">x&#39;</span>, y&#39;) := two_sort x y <span class="kr">in</span>
x&#39; &lt;= y&#39; /\ (x = x&#39; /\ y = y&#39; \/ y = x&#39; /\ x = y&#39;)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk66"><span class="highlight"><span class="nb">intros</span> x y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">x&#39;</span>, y&#39;) := two_sort x y <span class="kr">in</span>
x&#39; &lt;= y&#39; /\ (x = x&#39; /\ y = y&#39; \/ y = x&#39; /\ x = y&#39;)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk67"><span class="highlight"><span class="nb">unfold</span> two_sort.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">x&#39;</span>, y&#39;) :=
  <span class="kr">if</span> le_dec x y <span class="kr">then</span> (x, y) <span class="kr">else</span> (y, x) <span class="kr">in</span>
x&#39; &lt;= y&#39; /\ (x = x&#39; /\ y = y&#39; \/ y = x&#39; /\ x = y&#39;)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk68"><span class="highlight"><span class="nb">destruct</span> (le_dec x y).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x &lt;= y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt;= y /\ (x = x /\ y = y \/ y = x /\ x = y)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z3-tut-v-chk69" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ x &lt;= y</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z3-tut-v-chk69"><hr></label><div class="goal-conclusion"><span class="highlight">y &lt;= x /\ (x = y /\ y = x \/ y = y /\ x = x)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z3-tut-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="z3-tut-v-chk6a"><span class="highlight"><span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ x &lt;= y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">y &lt;= x /\ (x = y /\ y = x \/ y = y /\ x = x)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre></div>
<div class="section" id="there-ya-go">
<h1>There Ya Go</h1>
<p>So you see that it isn't that much harder if you lean on automation to do these problems in Coq rather than Z3. However, having said that, I did not do the most impressive tasks from the tutorial. Verifying a neural network or a sorting network are worthy blogposts in their own right.
</p>


