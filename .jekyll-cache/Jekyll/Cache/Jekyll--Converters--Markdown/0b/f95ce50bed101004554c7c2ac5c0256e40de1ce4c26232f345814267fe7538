I"5<p>April 2017</p>

<p>Racing firmware mostly</p>

<p>CleanFlight vs betaflight vs iNav. A family of related firmwares</p>

<p>iNav for autonomous, betaflight for latest</p>

<p>Betaflight might be taking over?</p>

<p>Ardupilot seems to be leader for autonomous drones</p>

<p>pixhawk is premier computer</p>

<p>http://ardupilot.org/dev/docs/raspberry-pi-via-mavlink.html</p>

<p>gstream for video streaming</p>

<p>http://www.einarsundgren.se/gstreamer-basic-real-time-streaming-tutorial/</p>

<p>https://gstreamer.freedesktop.org/documentation/tutorials/basic/gstreamer-tools.html</p>

<p>uv4l?</p>

<p>http://www.linux-projects.org/uv4l/</p>

<p>even better for streaming pi?</p>

<p>The only thing we have working is the webrtc brwoser based camera.</p>

<p>You need to click call to make it start</p>

<p>https://blog.athelas.com/a-brief-history-of-cnns-in-image-segmentation-from-r-cnn-to-mask-r-cnn-34ea83205de4</p>

<p>get avr branch of ardupilot</p>

<p>go into examples folder</p>

<p>make apm2</p>

<p>make apm2 upload</p>

<p>I am not registering my apm2.6 as a serial device. Ok,  my usb cable was bad. What are the odds?</p>

<p>installing apmplanner from http://ardupilot.org/planner2/docs/installation-for-linux.html</p>

<p>command is missing an underscore</p>

<p>rtl is return to launch</p>

<p>SITL is the recommended simulator</p>

<p>Installed vagrant to use SITL on mac</p>

<p>http://ardupilot.org/dev/docs/setting-up-sitl-using-vagrant.html</p>

<p>http://sourabhbajaj.com/mac-setup/Vagrant/README.html</p>

<p>I had to make a Vagrantfile to get it to work. By default vagrant was trying to use some nonsense</p>

<p>Make Vagrantfile with</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;code&gt;&lt;span class="no"&gt;Vagrant&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nf"&gt;configure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"2"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nf"&gt;vm&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nf"&gt;box&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"ubuntu/xenial64"&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;&lt;/code&gt;
</code></pre></div></div>

<p>https://www.vagrantup.com/intro/getting-started/boxes.html</p>

<p>JMavSim for software in the loop on pixhawk 2</p>

<p><a href="https://pixhawk.org/users/hil">https://pixhawk.org/users/hil</a></p>

<p><a href="https://pixhawk.org/dev/hil/jmavsim">https://pixhawk.org/dev/hil/jmavsim</a></p>

<p>What is the difference between apm planner and mission planner?</p>

<p>Setup pi as access point. Could use as radio then. Not very long range</p>

<p>https://learn.adafruit.com/setting-up-a-raspberry-pi-as-a-wifi-access-point/overview</p>

<p>supposedly the apm2.6 will connect through usb</p>

<p>Dronekit</p>

<p>http://python.dronekit.io/guide/quick_start.html</p>

<p>Mavlink and pymavlink. Evidently dronekit uses pymavlink</p>

<p>pymavlink is a low level python control of MAVlink messages.</p>

<p>mavproxy - is a command line ground station software. More feature packed than apm planner? Has ability to use multiple linked ground stations.</p>

<p>mavproxy can forward data to a given port. Useful, but I can’t find it documented in the mavproxy docs themselves</p>

<p>dronecode is a set of projects</p>

<p>https://www.dronecode.org/platform/</p>

<p>Really nice looking simulator</p>

<p>https://github.com/Microsoft/AirSim/blob/master/docs/linux_build.md</p>

<p>I had to sign up with epic games and link my gihub account to be able to clone the unreal engine</p>

<p>We’re using a Turnigy 9x. Got a ppm encoder to be able to attach to pixhawk</p>

<p>Setting up the pixhawk 2:</p>

<p>The motors need to be plugged in according to their number</p>

<p>http://ardupilot.org/copter/docs/connect-escs-and-motors.html</p>

<p>Download APM planner 2</p>

<p>Flashed the firmware</p>

<p>Ran through the initial calibration. Followed onscreen instructions.</p>

<p>Not immediately getting all the buttons working</p>

<p>http://ardupilot.org/copter/docs/common-rc-transmitter-flight-mode-configuration.htmlSw</p>

<p>Swapped channels 5 and 6 on controller to have flight mode siwtch</p>

<p>Flight modes</p>

<p>Stabilize - self level roll and pitch axes</p>

<p>FS_THR_Value error. Not sure why</p>

<p>Compass is not calibrating. Not sure why.</p>

<p>We had lots of problems until we uploaded the latest firmware. It loaded firmware at the beginning, but I guess it wasn’t the latest. We built APM Planner from source and perhaps that reupdating fixed the firmware to 3.5.1</p>

<p>Spinning up it flew but was spinning. We wired up the motors ccw and cw opposite to the wiring diagram but never changed it in the firmware.</p>

<p>Drone Code uses QGroundControl. This is sort of an APM Planner alternative.</p>

<p>v.channels gives a dict</p>

<p>channel 2 was right up down</p>

<p>channel 3 was left up down</p>

<p>Dronekit Cloud. Web apis for drone control? This kind of seems like for if you have a ton of drones. Forward looking</p>

<p>In the field we can connect to the drone using the phone as a hotspot.</p>

<p>It seems like only guided mode will accept mavlink commands</p>

<p>The controller modes override what the pi says.</p>

<p>Stabilize mode should ignore mavlink commands? In case they get wonky.</p>

<p>RTL.</p>

<p>So we set the controller to have flight mode settings. In those three modes, in case something goes wrong.</p>

<p>put this in a dronerun file</p>

<p>python “$@” &amp;</p>

<p>So that you won’t have the program stop when ssh pipe dies.</p>

<p>Need to set RTL speed and altitude. Dafult may be alarming</p>

<p>WPNAV_SPEED</p>

<p>250 up default</p>

<p>150 down default</p>

<p>Crash on RTL mode. (Toilet bowl behavior? Seemed to be moving in a circle. ) I also felt like the loiter mode responded counter intuitively to my commands.</p>

<p>We’d like to use raspberry pi camera for visual odometry</p>

<h3 id="vision_position_delta">VISION_POSITION_DELTA</h3>

<p>Mavlink message is implemented in ardupilot</p>

<p>https://github.com/PX4/OpticalFlow</p>

<p>http://mavlink.org/messages/common#OPTICAL_FLOW_RAD</p>

<p>http://ardupilot.org/dev/docs/copter-commands-in-guided-mode.html</p>

<p>actual source</p>

<p>https://github.com/ArduPilot/ardupilot/blob/master/ArduCopter/GCS_Mavlink.cpp#L967</p>

:ET